/*--------------------------------*- C++ -*----------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  dev                                   |
|   \\  /    A nd           | Website:  www.openfoam.com                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    object      blockMeshDict;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

scale 1e-3; //1e-3

radius 10.0;

xmax #eval "0.9990482215818578*$radius"; 
ymin #eval "-0.043619387365336*$radius";
ymax #eval "0.043619387365336*$radius";
zmin -8.0;
zmax  8.0;
cells 40;

vertices
(
    (0 0 $zmin) //0
    ($xmax $ymax $zmin) //1
    ($xmax $ymax $zmax) //2
    (0 0 $zmax) //3
    ($xmax $ymin $zmin) //4
    ($xmax $ymin $zmax) //5
);

// Refinment settings
d_h 50.e-3;

// X axis two zones
x_1 3.; // length of closer to X=0 refined zone
x_2 7.;
d_h_x $d_h; // part of cells in the refined zone 1 in proportion to size (uniform if k==1)
k_x 1.1; // expansion factor for unrefined zone

// Z axis four zones in increae of Z
d_h_z $d_h;
z_1 5.0;
z_2 3.0;
z_3 0.5;
z_4 7.5;
k_z 1.1;

// Evaluation for X axis
one_by_lnk_x #eval "1/log($k_x)";
N_x #eval "round($one_by_lnk_x*log(pow($k_x,$x_1/$d_h_x)*($d_h_x - $x_2*(1 - $k_x))/$d_h_x))";//floor
th_x_1 #eval "$x_1/($N_x*$d_h_x)";
th_x_2 #eval "$one_by_lnk_x*log(($d_h_x - $x_2*(1 - $k_x))/$d_h_x)/$N_x";
sigma_x_1 1.;
sigma_x_2 #eval "pow($k_x,$N_x*$th_x_2)";

// Evaluation for Z axis
one_by_lnk_z #eval "1/log($k_z)";
N_z #eval "round($one_by_lnk_z*log(pow($k_z,($z_2+$z_3)/$d_h_z)*($d_h_z - $z_1*(1 - $k_z))*($d_h_z - $z_4*(1 - $k_z))/sqr($d_h_z)))";
th_z_1 #eval "$one_by_lnk_z*log(($d_h_z - $z_1*(1 - $k_z))/$d_h_z)/$N_z";
th_z_2 #eval "$z_2/($N_z*$d_h_z)";
th_z_3 #eval "$z_3/($N_z*$d_h_z)";
th_z_4 #eval "$one_by_lnk_z*log(($d_h_z - $z_4*(1 - $k_z))/$d_h_z)/$N_z";
sigma_z_1 #eval "pow($k_z,-$N_z*$th_z_1)";
sigma_z_2 1.;
sigma_z_3 1.;
sigma_z_4 #eval "pow($k_z,$N_z*$th_z_4)";


blocks
(
 hex (0 4 1 0 3 5 2 3) ($N_x  1 $N_z)
 simpleGrading
 (
    (
        ($x_1           $th_x_1                 $sigma_x_1)
        ($x_2           $th_x_2             $sigma_x_2)
    )
    1
    (
        ($z_1           $th_z_1                 $sigma_z_1)
        ($z_2           $th_z_2                 $sigma_z_2)
        ($z_3           $th_z_3                 $sigma_z_3)
        ($z_4           $th_z_4                 $sigma_z_4)
    )
)
);

edges
(
);

boundary
(
    bottom
    {
        type wall;
        faces
        (
            (0 4 1 0)
        );
    }
    top
    {
        type wall;
        faces
        (
            (3 5 2 3)
        );
    }
    front
    {
        type wedge;
        faces
        (
            (0 1 2 3)
         );
    }
    back
    {
	    type wedge;
	    faces
	    (
	      (0 3 5 4)
	    );
    }	    
    side
    {
	type wall;
	faces
	(
	 (1 4 5 2)
	);
    }
    axis
    {
	type empty;
	faces
	(
	 (0 3 3 0)
 	);	 
    }
);

// ************************************************************************* //
